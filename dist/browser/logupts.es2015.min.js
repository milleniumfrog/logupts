class Placeholder{constructor(e,t){this.key=e,this.replaceVar=t}replace(e,t){return"string"==typeof this.replaceVar?this.replaceVar:0===t.length?this.replaceVar(e):(t=`[${t}]`,this.replaceVar(e,JSON.parse(t)))}}let defaultPlaceholders={date:new Placeholder("date",`${fillStrWithZeros(2,String((new Date).getDate()))}`),day:new Placeholder("day",`${fillStrWithZeros(2,String((new Date).getDay()))}`),month:new Placeholder("month",`${fillStrWithZeros(2,String((new Date).getMonth()+1))}`),fullYear:new Placeholder("fullYear",`${(new Date).getFullYear()}`),year:new Placeholder("year",`${(new Date).getFullYear()}`),hours:new Placeholder("hours",`${fillStrWithZeros(2,String((new Date).getHours()))}`),minutes:new Placeholder("minutes",`${fillStrWithZeros(2,String((new Date).getMinutes()))}`),seconds:new Placeholder("seconds",`${fillStrWithZeros(2,String((new Date).getSeconds()))}`),frog:new Placeholder("frog","All Contributers: milleniumfrog"),service:new Placeholder("service",e=>`[${e.activeService}]`)};function fillStrWithZeros(e,t){if(e<t.length)throw new Error("the message is longer than the wished length.");for(let r=t.length;r<e;++r)t="0"+t;return t}const DEBUG=!0;class LogUpTs{constructor(e={}){this.loguptsOptions=this.defaultLogUpTsOptions(),this.placeholderVars={activeService:"LOG"},this.loguptsOptions=this.mergeLogUpTsOptions(this.loguptsOptions,e)}generateString(e){e=e||"";let t=this.loguptsOptions.placeholders||{};for(let r in t){let s=new RegExp(`{{${t[r].key}}}`,"gi");e=e.replace(s,t[r].replace(this.placeholderVars,""))}return e}static generateString(e,t){t=t||"";let r=e.loguptsOptions.placeholders||{};for(let s in r){let o=new RegExp(`{{${r[s].key}}}`,"gi");t=t.replace(o,r[s].replace(e.placeholderVars,""))}return t}defaultLogUpTsOptions(){return{praefix:"{{service}} ",postfix:"",placeholders:defaultPlaceholders,quiet:!1,transports:[],customAsyncExecutions:[],customExecutions:[]}}mergeStringArray(e){let t="";for(let r of e)"string"!=typeof r&&(r=this.mergeStringArray(r)),t+=r;return t}prepareLogUpTsOptions(e,t){if("string"==typeof e){if(void 0===t)throw new TypeError("if loguptsOptions is a string then the messageArr is needed");return t.unshift(e),this.loguptsOptions}if(void 0===e){if(void 0===t)throw new TypeError("if loguptsOptions is a string then the messageArr is needed");return t.unshift(""),this.loguptsOptions}{let t=this.copyLotUpTsOptions(this.loguptsOptions);for(let r in e)t[r]=e[r];return t}}mergeLogUpTsOptions(e,t){let r=this.copyLotUpTsOptions(e);for(let e in t)r[e]=t[e];return r}copyLotUpTsOptions(e){let t=this.defaultLogUpTsOptions();for(let r in e)switch(r){case"placeholders":let s={},o=t.placeholders||{},i=e.placeholders||{};for(let e in o)s[e]=new Placeholder(e,o[e].replaceVar);for(let e in i)s[e]=new Placeholder(e,i[e].replaceVar);t.placeholders=s;break;case"transports":let n=(t.transports||[]).slice(0),l=e.transports||[];for(let e of l)n.push(e);t.transports=n;break;case"customExecutions":let a=(t.customExecutions||[]).slice(0);for(let t of e.customExecutions||[])a.push(t);t.customExecutions=a;break;case"customAsyncExecutions":let c=(t.customAsyncExecutions||[]).slice(0);for(let t of e.customAsyncExecutions||[])c.push(t);t.customAsyncExecutions=c;break;default:t[r]=e[r]}return t}execInternalOptions(e){for(let t in e)switch(t){case"activeService":this.placeholderVars.activeService=e.activeService}}internal(e,t,...r){let s=this.mergeLogUpTsOptions(this.loguptsOptions,e);this.execInternalOptions(t);let o=s.praefix+this.mergeStringArray(r)+s.postfix;o=this.generateString(o);for(let e of s.customExecutions||[])e();if(s.quiet||console.log(o),0===(s.transports||[]).length&&0===(s.customAsyncExecutions||[]).length)return o;{let e=[],r=s.transports||[];for(let s of r)e.push(s.exec(t||{},o));for(let t of s.customAsyncExecutions||[])e.push(t());return Promise.all(e).then(()=>o)}}log(e,...t){let r=this.prepareLogUpTsOptions(e,t);return this.internal(r||{},{activeService:"LOG",groups:["ALL","LOG"]},t)}warn(e,...t){let r=this.prepareLogUpTsOptions(e,t);return this.internal(r||{},{activeService:"WARN",groups:["ALL","WARN"]},t)}error(e,...t){let r=this.prepareLogUpTsOptions(e,t);return this.internal(r||{},{activeService:"ERROR",groups:["ALL","ERROR"]},t)}info(e,...t){let r=this.prepareLogUpTsOptions(e,t);return this.internal(r||{},{activeService:"INFO",groups:["ALL","INFO"]},t)}custom(e,t,r,...s){let o=this.prepareLogUpTsOptions(r,s),i={activeService:"CUSTOM",groups:["ALL","CUSTOM",e]};return o.praefix=e,o.postfix=t,this.internal(o||{},i,s)}}export{Placeholder,defaultPlaceholders,DEBUG,LogUpTs};